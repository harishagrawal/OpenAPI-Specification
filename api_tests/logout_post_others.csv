import random
import csv
import faker
from datetime import datetime, timedelta

fake = faker.Faker()

# Define the field names for the CSV
fields = ['description', 'error', 'schema_field', 'value']

# Generate a list of dictionaries, each representing a row of data
rows = []
for _ in range(10):
    row = {}
    row['description'] = fake.sentence(nb_words=6)
    row['error'] = random.choice([None, fake.word()])
    row['schema_field'] = fake.word()
    row['value'] = random.choice([fake.word(), fake.number(), None, str(datetime.now() - timedelta(days=random.randint(1,100)))[:10]])
    rows.append(row)

# Write the data to a CSV file
with open('dummy_data.csv', 'w', newline='') as csvfile:
    writer = csv.DictWriter(csvfile, fieldnames=fields)
    writer.writeheader()
    for row in rows:
        writer.writerow(row)
